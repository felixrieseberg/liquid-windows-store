(function(n){function e(){function o(n,t,i){var u=i.s===t,r,f,e;return u||(t=t||0,r=n.charCodeAt(t),i.s=-1,r<55296||r>57343?i.c=r:r<=56319?(f=r,e=n.charCodeAt(t+1),i.c=(f-55296)*1024+(e-56320)+65536,i.s=t+1):(i.c=-1,u=!0)),!u}var t=this,e=!1,i={};t.addStrings=function(t){n.extend(i,t)},t.getString=function(n,r){var u=i[n]||t.format("ERROR: {0}",n);return r?t.encodeHtml(u):u},t.startsWith=function(n,t){return n.substr(0,t.length)===t},t.format=function(n){function f(n){var t=i[parseInt(n.replace(u,""))];return t==null&&(t=""),t}for(var i=[],t=0;t<arguments.length-1;t++)i[t]=arguments[t+1];return n.replace(r,f)},t.dispose=function(){e||(i=null,e=!0)},t.encodeHtml=function(n){if(!n)return"";var t={c:0,s:-1};return n.replace(f,function(n,i,r){return o(r,i,t)?["&#",t.c,";"].join(""):""})}}var t=window,i=t.MSA.MeControl,r=/\{\d+\}/g,u=/[\{\}]/g,f=/[^\w .,-]/g;i.Strings=new e})(window.MejQuery),function(){var r=window,n=r.MSA.MeControl,t=n.Strings,u="uictx",f="me",i="([&?]{0}=)[^&]*";n.Util={appendQueryParams:function(n,t){var i,r;if(!n)return"";i=[];for(r in t)i.push(r+"="+(t[r]?t[r]:""));return i.length===0?n:n+(n.indexOf("?")===-1?"?":"&")+i.join("&")},appendContextParam:function(n,t){return t=t||{},t[u]=f,this.appendQueryParams(n,t)},hasQueryParam:function(n,r){var u=t.format(i,r),f=new RegExp(u);return f.test(n)},setQueryParam:function(n,r,u){var o=t.format(i,r),e=new RegExp(o),f;return e.test(n)?n.replace(e,"$1"+u):(f={},f[r]=u,this.appendQueryParams(n,f))},getCookie:function(n){return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(n).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null}}}(),function(){function e(i,r,e){function a(){var n=i.prop("src")||r;return t[n]||(t[n]={succeeded:!1,instances:[]}),t[n]}function p(){var t=a(),i;if(!t.succeeded&&(t.succeeded=!0,t.instances.length>0))for(n.logQos("TileLoad",!1,Date.now()-c,"ImageRestored: "+r,{url:r}),i=0;i<t.instances.length;i++)t.instances[i].reset();n.logQos("TileLoad",!0,Date.now()-c)}function v(){var t,r,u,f,e,o;try{if(p(),u=0,r=i[0].naturalWidth,t=i[0].naturalHeight,f=i.css("width"),e=i.css("height"),r==1&&t==1||f=="1px"&&e=="1px"){y();return}if(o=Math.round,r&&t&&r!=t)if(r>t){var s=parseInt(e),h=parseInt(f),c=o(r*(s/t));u=-o((c-h)/2),i.css({width:"auto","max-width":"none","margin-left":u+"px"})}else i.css({height:"auto","max-height":"none"});i.css("visibility","")}catch(l){n.logEvent("TileLoadError",{message:l.message})}}function y(){var t,f,u;try{f=a(),f.instances.push(o),t=i.parent(),i.remove(),u=e,i.attr("src")!=u&&(n.logQos("TileLoad",!0,Date.now()-c,"ImageFailed: "+r,{url:r,clientError:!0}),setTimeout(function(){i&&i.attr("src",u).css("visibility","")},0))}catch(s){n.logEvent("TileLoadError",{message:s.message})}finally{null!=t&&t.append(i)}}var o=this,l=!1,s=!1,h=!1,c;o.activate=function(){if(i&&!l)if(l=!0,s=!0,c=Date.now(),i.prop("src")===r)v();else{i.on("load",v);i.on("error",y);r&&u.startsWith(r.toLowerCase(),f)?i.prop("src",r):i.prop("src",e)}},o.deactivate=function(){s&&!h&&(s=!1,i&&i.off())},o.reset=function(){s&&!h&&(o.deactivate(),l=!1,o.activate())},o.dispose=function(){h||(o.deactivate(),i=null,h=!0)}}var r=window,i=r.MSA.MeControl,u=i.Strings,n=i.Log,t={},f="https://";i.PictureLoaderCache={isCached:function(n){return t[n]&&t[n].succeeded}},i.PictureLoader=e}(),function(){function u(n,t,r){var u=n.exec(i);return u&&u[1]===t&&u[2]===r}var n=window,t=n.MSA.MeControl,i=navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase(),r=/(msie) ([\w.]+)/;t.Browser={ie8:u(r,"msie","8.0")}}(),function(n){function p(p){function et(){g=!0,w.hasActiveUser()&&(g=!!(b.memberName&&b.idp),b.idp===t.MSA&&(g=!!(g&&b.cid)),w.isReady()&&d.setActiveUser(b)),b=n.extend({},v,b),g=!!(g&&k&&(k.msaInfo||k.aadInfo)),k=n.extend(!0,{},y,k),r.hasQueryParam(k.msaInfo.accountSettingsUrl,"ref")||(k.msaInfo.accountSettingsUrl=r.appendQueryParams(k.msaInfo.accountSettingsUrl,{ref:"MeControl"})),it=w.imageUrl("bluemanmxxl.png"),ut=w.imageUrl("Blue_round_AD.PNG"),rt=w.imageUrl("Gray_round_AD.PNG"),ft=w.imageUrl("cross.png"),ht()}function ot(n){if(!n)return!1;var t=w.getIdpInfo(n);return!!(t&&t.meUrl)}function ht(){if(g&&!w.hasActiveUser()&&k.msaInfo&&p.autoSignIn&&k.msaInfo.signInUrl&&p.autoSignInReturnUrl&&ct()){var t=n('<iframe class="msame_auto_frame">');t.attr("src",vt()),n(document.body).append(t)}}function ct(){return!!r.getCookie(o)}function lt(){var n=u.format("{0}=; path=/; expires=Fri, 31 Dec 9999 23:59:59 GMT",o);document.cookie=n}function at(){var n=u.format("{0}=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT",o);document.cookie=n}function vt(){var i=t.MSA,n=k.msaInfo.signInUrl,f=encodeURIComponent(p.autoSignInReturnUrl),u;return n=r.setQueryParam(n,h[i],f),u={},r.hasQueryParam(n,s[i])||(u[s[i]]="1"),r.appendContextParam(n,u)}p=p||{},p.events=p.events||{},p.mobileBreakpoints=p.mobileBreakpoints||{};var w=this,nt=!1,g=!0,b=p.userData,k=p.rpData,st=p.urlBase,tt=null,it,rt,ut,ft,d=null;w.options=p||{},w.imageUrl=function(n){return u.format("{0}/MeControl/{1}/{2}",st,i.Version,n)},w.errorImgUrl=w.imageUrl("bluemanmxxl.png"),w.isValid=function(){return g},w.isReady=function(){return!!(g&&d)},w.mobileState=function(){var n=p.mobileBreakpoints,t=i.MobileState;return n.mobile&&n.mobile>=e.innerWidth?t.Mobile:n.shortHeader&&n.shortHeader>=e.innerWidth?t.ShortHeader:t.Full},w.hasActiveUser=function(){return b&&b.authenticatedState==i.AuthState.SignedIn},w.setActiveUser=function(n){n&&(b=n,et())},w.getProfileUrl=function(n){var i,f,e;n=n||{},i="";switch(n.idp){case t.MSA:i=u.format(a,n.cid,p.isINT?"-int":"",r.getCookie("upck")||"1");break;case t.AAD:f=n,i=f.largeTileUrl||f.smallTileUrl||f.tileUrl||(ot(n.idp)?ut:rt);break;case t.MSA_FED:e=n,i=e.largeTileUrl||e.smallTileUrl||e.tileUrl||it}return i},w.getDisplayName=function(n){n=n||{};var f=function(n,t){return u.format(i.Loc.lf?"{1} {0}":"{0} {1}",n,t)},r="";switch(n.idp){case t.MSA:r=f(n.firstName,n.lastName);break;case t.AAD:case t.MSA_FED:r=n.displayName||(n.firstName&&n.lastName?f(n.firstName,n.lastName):"")}return r},w.headerData=function(){var u=i.Loc.lf?b.lastName:b.firstName,n,r;switch(b.idp){case t.MSA:n=u;break;case t.AAD:case t.MSA_FED:n=b.displayName||u}return n=n||b.memberName,r=p.headerHeight,r=typeof r=="number"?Math.max(l,Math.min(c,r)):0,{displayName:n,displayNameMobile:w.getDisplayName(b),tileUrl:w.getProfileUrl(b),memberName:b.memberName||"",authenticatedState:b.authenticatedState,errorImgUrl:w.errorImgUrl,chevronImgUrl:w.imageUrl("Chevronpng.png"),height:r,mobileState:w.mobileState(),chevHtml:p.custom&&p.custom.chevHtml}},w.activeAccountData=function(){return{idp:b.idp,firstName:b.firstName||"",lastName:b.lastName||"",displayName:b.displayName||"",orgName:b.orgName||"",memberName:b.memberName||"",accountUrl:w.getIdpInfo().accountSettingsUrl,tileUrl:w.getProfileUrl(b),errorImgUrl:w.errorImgUrl}},w.getAccountItemData=function(n){return{tileUrl:w.getProfileUrl(n),displayName:w.getDisplayName(n),authenticatedState:n.authenticatedState,memberName:n.memberName,errorImgUrl:w.errorImgUrl,enabled:ot(n.idp),onSwitchUser:function(){w.switchToUser(n)},onSignOutUser:function(t,i){w.signOutUser(n,t,i)},removeImgUrl:ft}},w.userData=function(){return b},w.getIdpInfo=function(n){n=n||b.idp;var i;switch(n){case t.MSA:i=k.msaInfo;break;case t.AAD:i=k.aadInfo;break;case t.MSA_FED:i=k.aadInfo}return i||{}},w.rpData=function(){return k},w.userStateModel=function(n){return!d&&n&&(d=n,w.hasActiveUser()&&d.setActiveUser(b),d.getUserState(function(){})),d},w.extensibleLinks=function(n){var i,t;if(n){for(i=n instanceof Array,t=0;i&&t<n.length;t++)n[t].string&&n[t].onClick&&n[t].onClick instanceof Function||(i=!1);i&&(tt=n),f.logQos("SetExtensibleLinks",i,0)}return tt},w.dispose=function(){nt||(d&&d.dispose(),k=b=d=null,nt=!0)},w.signOut=function(){f.logEvent("SignOutAll",{userCount:d.currentState().length,currentUser:w.hasActiveUser()?b.idp:"none"}),p.events.onBeforeSignOut&&p.events.onBeforeSignOut(b),k.msaInfo&&p.autoSignIn&&lt(),d.signOut(b)},w.signIn=function(){f.logEvent("SignIn",{userCount:d.currentState().length}),p.events.onSignIn?p.events.onSignIn():(k.msaInfo&&p.autoSignIn&&at(),e.location.href=r.appendContextParam(d.getSignInUrl()))},w.switchToUser=function(n){f.logEvent("SwitchUser",{userCount:d.currentState().length,idp:n&&n.idp,currentUser:w.hasActiveUser()?b.idp:"none"})},w.signOutUser=function(n,t,i){f.logEvent("RemoveUser",{userCount:d.currentState().length,idp:n&&n.idp,currentUser:w.hasActiveUser()?b.idp:"none"}),d.signOutUser(n,t,i)},et()}var e=window,i=e.MSA.MeControl,u=i.Strings,f=i.Log,r=i.Util,t=i.IDP,c,l;i.MobileState={Full:0,ShortHeader:1,Mobile:2};var o="msame_asi",a="https://cid-{0}.users.storage.live{1}.com/users/0x{0}/myprofile/expressionprofile/profilephoto:Win8Static,UserTileMedium,UserTileStatic/MeControlXXLUserTile?ck={2}&ex=24",v={smallTileUrl:"",authenticatedState:""},y={msaInfo:{signInUrl:"",signOutUrl:"",accountSettingsUrl:"https://account.microsoft.com",switchUrl:"",meUrl:""},preferredIdp:t.MSA},h={},s={};h[t.MSA]="wreply",s[t.MSA]="checkda",c=100,l=44,i.MeControlModel=p}(window.MejQuery),function(n){function h(r){function tt(){var u,f,r;y&&!v&&(u=c.mobileState===t.MobileState.Mobile,f=c.mobileState===t.MobileState.ShortHeader,h.toggleClass("msame_Mobile",u),h.toggleClass("msame_Short",f),c.authenticatedState==t.AuthState.SignedIn&&(r=n(".msame_Header_name",h),r.show(),f?r.hide():u?(r.remove(),r.html(i.format(o,i.encodeHtml(c.displayNameMobile),i.encodeHtml(c.memberName))),r.insertAfter(p),et()):(r.remove(),r.text(c.displayName),r.insertBefore(p))))}function et(){d||(c.chevHtml?w.append(c.chevHtml):w.append(i.format('<img src="{0}">',c.chevronImgUrl)),d=!0)}function it(){if(!v&&!h.is(":visible")){b||(b=!0,setTimeout(function(){b=!1,it()},500));return}var n;c.mobileState===t.MobileState.Mobile&&(n=h.outerWidth()-p.outerWidth()-w.outerWidth()-5),nt.css("max-width",n||"")}function rt(){h.css("outline-style","none")}function ut(t,i){t.preventDefault(),t.stopPropagation(),n(l).trigger("click",{isKeyboard:i})}function ot(n){n&&(n.which===32||n.which===13)&&ut(n,!0)}function st(){h.css("outline-style","")}var l=this,y=!1,v=!1,c=r,b=!1,d=!1,g=c.authenticatedState==t.AuthState.SignedIn,a=null,h=null,p=null,nt=null,w=null,ft=null,k=null;l.elements=function(){return{anchor:h}},l.setMobileState=function(n){c.mobileState!==n&&(c.mobileState=n,tt())},l.render=function(){var h="",l=i.getString("signin"),a,f,o,u;return g&&(a=t.PictureLoaderCache.isCached(c.tileUrl)?c.tileUrl:"",h=i.format(s,a),l=c.displayName),f=i.format(e,i.encodeHtml(l),h),r.height>0?(o=r.height-28+"px",u=n("<div>").append(f),n(".msame_Header_picframe, .msame_Header_picframe img",u).css({height:o,width:o}),n(".msame_Header_name",u).css("line-height",r.height+"px"),u.html()):f},l.activate=function(){if(!y&&!v){y=!0,h=n(".msame_Header"),p=n(".msame_Header_pic",h),nt=n(".msame_Header_name",h),w=n(".msame_Header_chev",h),k=n(".msame_Header_pic img",h),ft=n(".msame_Header_piccont",h);h.on("click",ut);h.on("keydown",ot);h.on("blur",st);h.on("mousedown",rt);h.on("touchstart",rt);h.toggleClass("msame_unauth",!g);u.on("resize"+f,it);t.Browser.ie8&&h.addClass("msaie8"),a||(a=new t.PictureLoader(k,c.tileUrl,c.errorImgUrl)),c.mobileState!==t.MobileState.Full&&tt(),setTimeout(a.activate,0)}},l.deactivate=function(){y&&!v&&(y=!1,u.off("resize"+f),h.off(),a&&a.deactivate())},l.dispose=function(){v||(l.deactivate(),a&&(a.dispose(),a=null),h.remove(),c=r=null,k=h=null,v=!0)}}var r=window,u=n(r);r.MSA=r.MSA||{};var t=r.MSA.MeControl=r.MSA.MeControl||{},i=t.Strings,e='<div class="msame_Header" tabIndex="0"><div class="msame_Header_name msame_TxtTrunc">{0}<\/div>{1}<div class="msame_Header_chev"><\/div><\/div>',o='<div class="msame_TxtTrunc msame_Header_fullName">{0}<\/div><div class="msame_TxtTrunc msame_Header_email">{1}<\/div>',s='<div class="msame_Header_pic"><div class="msame_Header_piccont"><div class="msame_Header_picframe"><img role="presentation" src="{0}"><\/div><\/div><\/div>',f=".msameheader";t.MeHeaderControl=h}(window.MejQuery),function(n){function f(f){function tt(){if(s=new t.MeControlModel(y),v=s.mobileState(),!s.isValid()){i.logQos("modelValidate",!1,0,"MissingData");return}u.on("resize",ut);setTimeout(function(){i.logEvent("$MeControlReady",{duration:Date.now()-a.startTime})},0),d(),nt()}function b(){c&&(n(c).off(),c.dispose()),c=null}function k(){h&&(n(h).off(),h.dispose()),h=null}function d(){if(!c){c=new t.MeHeaderControl(s.headerData()),w.html(c.render()),c.activate();n(c).on("click",it);i.logEvent("HeaderReady",{duration:Date.now()-a.startTime})}}function g(){if(!t.MeDropdownControl){l.dispose(),a.showHeaderNoJs();return}if(!h&&c){t.IFrameControl.init(),s.userStateModel(new t.UserStateModel(y.rpData,t.Config.aad,y.isINT)),h=new t.MeDropdownControl(s,c.elements()),n("body").append(h.render()),h.activate();n(h).on("visible",rt);i.logEvent("DropdownReady",{duration:Date.now()-a.startTime})}}function nt(){var i=a.getJsUrl("meCore");t.MeDropdownControl?g():n(r.document).ready(function(){a.loadScript(i,"meCore",function(){g()},function(){})})}function it(n,t){if(!s.hasActiveUser()&&s.isReady()&&s.userStateModel().currentState().length===0){s.signIn();return}h&&h.toggle(t&&t.isKeyboard)}function rt(n,t){w.toggleClass("msame_open",t||t.visible)}function ut(){if(!p){var n=s.mobileState();v!==n&&(v=n,c&&c.setMobileState(v),h&&h.setMobileState(v))}}var l=this,p=!1,a=t.Loader,v,y=f||a.getOptions(),s=null,c=null,h=null,w=n("#"+y.containerId);l.setActiveUser=function(n){if(s.setActiveUser(n),!s.isValid()){i.logQos("SetActiveUser",!1,0,"MissingData");return}i.logQos("SetActiveUser",!0,0),b(),k(),d(),nt()},l.setExtensibleLinks=function(n){s.extensibleLinks(n),h&&h.updateExtensibleLinks()},l.reinit=function(n){l.dispose(),o(n,y)},l.dispose=function(){p||(b(),k(),s&&s.dispose(),s=null,t.IFrameControl&&t.IFrameControl.dispose(),u.off(e),r.MSA.$MeControl=null,p=!0)},setTimeout(tt,0);u.on("unload"+e,l.dispose)}function o(u,e){t.Loader.startTime=Date.now(),u.events&&u.events.onEventLog&&i.setLogEvent(u.events.onEventLog),u.urlBase=e.urlBase,u=n.extend({},e,u),r.MSA.$MeControl=new f(u)}var r=window,u=n(r),t=r.MSA.MeControl,i=t.Log,e=".msame";t.MeController=f,r.MSA.$MeControl=new f}(window.MejQuery);window.MSA.MeControl.Loc={rtl:false,lf:false};window.MSA.MeControl.Strings.addStrings({
"signin":"Sign in",
"signout":"Sign out"});window.MSA.MeControl.Loader.scriptLoaded('meBoot');