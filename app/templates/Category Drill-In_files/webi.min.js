(function(){function k(){function i(){for(var f=n+"=",e=document.cookie.split(";"),i,r,u=0;u<e.length;u++){for(i=e[u];i.charAt(0)==" ";)i=i.substring(1);if(i.indexOf(f)!=-1)return r=i.substring(f.length,i.length),r.length>0&&(r=t+r),r}return""}var n="MUID",t="t:";return i()}var n=this,o,f,u,e,l,a,v;this.Asimov=this.Asimov||{};this.Asimov._schemas=this.Asimov._schemas||[];this.Asimov.uploadUrl="https://vortex.data.microsoft.com/collect/v1";this.Asimov.commonSchemaEnvelopeVersion="2.1";this.Asimov.javascriptVersion="2.15.3.8";this.Asimov.correlationVectorTag="cV";this.Asimov.correlationVectorHeader="MS-CV";this.Asimov.originatingCLLTag="cll";this.Asimov.experimentIdTag="expId";this.Asimov.userId=k();this.Asimov.allowedGetLength=2048;this.Asimov.getMethodQueryStringParameter="json";o="JS:";f="appId";this.Asimov.verbosityLevels={NONE:0,ERROR:1,WARNING:2,INFORMATION:3};Object.freeze&&Object.freeze(this.Asimov.verbosityLevels);this.Asimov.consoleVerbosity=this.Asimov.verbosityLevels.NONE;var s=63,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=null;"withCredentials"in new window.XMLHttpRequest?r="jQuery":window.XDomainRequest&&(r="XDomainRequest");u="Unknown";e=n.navigator&&n.navigator.appVersion?n.navigator.appVersion:"";e.indexOf("Win")!=-1?u="Windows":e.indexOf("Mac")!=-1?u="MacOS":e.indexOf("X11")!=-1?u="Unix":e.indexOf("Linux")!=-1&&(u="Linux");l=window.location.hostname;a=function(){for(var t="",n=0;n<16;n++)t+=h.charAt(Math.floor(Math.random()*h.length));return t};this.Asimov.CorrelationVector=function(){var i="0000000000000000",n=i,t=0,r=function(){return n===i?!1:!0},u=function(n){return n.getValue().length+2<=s?!0:!1},f=function(){return n.length+1+(t+1+"").length<=s?!0:!1};this.getValue=function(){return n.concat(".",t)};this.setValue=function(i){if(Asimov.CorrelationVector.isValid(i)){var r=i.lastIndexOf(".");n=i.substr(0,r);t=parseInt(i.substr(r+1),10)}else throw"Cannot set invalid correlation vector value";return n.concat(".",t)};this.init=function(){return n=a(),this.getValue()};this.extend=function(){return r()||this.init(),u(this)&&(n=n.concat(".",t),t=0),this.getValue()};this.increment=function(){return r()||this.init(),f()&&(t=t+1),this.getValue()}};v=new RegExp("^["+h+"]{16}(.[0-9]+)+$");this.Asimov.CorrelationVector.isValid=function(n){return v.test(n)&&n.length<=s};this.Asimov.cv=new this.Asimov.CorrelationVector;var d=function(){return n.jQuery?!n.JSON||!n.JSON.stringify?(t("Unable to write event: the global JSON.stringify method does not exist"),!1):r?r=="XDomainRequest"&&n.Asimov.uploadUrl&&n.Asimov.uploadUrl.indexOf(window.location.protocol)!=0?(t("Unable to write event: CORS requests are not supported cross-protocol in this browser"),!1):!0:(t("Unable to write event: CORS not supported in this browser"),!1):(t("Unable to write event: jQuery is not present"),!1)},y=function(n,i){t("Failure sending data to vortex: "+i)},c=function(){nt("Success sending data to vortex")},g=function(){t("Failure sending data to vortex using XDomainRequest")},t=function(t){n.Asimov.consoleVerbosity>=n.Asimov.verbosityLevels.ERROR&&n.console&&n.console.error&&n.console.error("JSLL: "+t)},p=function(t){n.Asimov.consoleVerbosity>=n.Asimov.verbosityLevels.WARNING&&n.console&&n.console.warn&&n.console.warn("JSLL: "+t)},nt=function(t){n.Asimov.consoleVerbosity>=n.Asimov.verbosityLevels.INFORMATION&&n.console&&n.console.log&&n.console.log("JSLL: "+t)},i=function(n,t){if(n=="string")return typeof t=="string"||t instanceof String||t instanceof Date;if(n=="bool")return typeof t=="boolean"||t instanceof Boolean;if(!(typeof t=="number")||t instanceof Number)return!1;if(n=="uint8"){if(t<0||t>255||t%1!=0)return!1}else if(n=="uint16"){if(t<0||t>65535||t%1!=0)return!1}else if(n=="uint32"){if(t<0||t>4294967295||t%1!=0)return!1}else if(n=="uint64"){if(t<0||t>18446744073709551615||t%1!=0)return!1}else if(n=="int8"){if(t<-128||t>127||t%1!=0)return!1}else if(n=="int16"){if(t<-32768||t>32767||t%1!=0)return!1}else if(n=="int32"){if(t<-2147483648||t>2147483647||t%1!=0)return!1}else if(n=="int64"){if(t<-9223372036854775808||t>9223372036854775807||t%1!=0)return!1}else if(n=="float"){if(t<-3402823e32||t>3402823e32)return!1}else if(n=="double"&&(t<-17976931348623157e292||t>17976931348623157e292))return!1;return!0},w=function(n,r,u){for(var h=r.fields,f,e,a,s,v,o,y,p,b,l,c=0;c<h.length;c++){if(f=h[c],e=u[f.name],e===null||e===undefined){if(f.req)return t("Missing required property: "+f.name),!1;continue}if(f.type=="map"){a={};for(s in e){if(!i(f.key,s))return t("A key in the map was of the wrong type: "+f.name),!1;if(!i(f.element,e[s]))return t("A value in the map was of the wrong type: "+f.name),!1;a[s]=e[s]}n[f.name]=a}else if(f.type=="list"||f.type=="set"){if(v=[],Object.prototype.toString.call(e)==="[object Array]")for(o=0;o<e.length;o++){if(e[o]!=null&&!i(f.element,e[o]))return t("The list contains a value of the wrong type: "+f.name),!1;v[o]=e[o]}else return t("The "+f.type+" "+f.name+" was not an array as expected"),!1;n[f.name]=v}else if(f.type=="struct"){if(y={},!w(y,f.def,e))return!1;n[f.name]=y}else{if(!i(f.type,e))return t("Property is the wrong type: "+f.name),!1;n[f.name]=e}}for(p in u){for(b=!1,l=0;l<h.length;l++)if(h[l].name==p){b=!0;break}b||t("An unexpected property was found in the event content and dropped: "+p)}return!0},b=function(t,i){var f,o,a,v,w,s,h,l,b,e,u;if(t&&d()){if(f=i==!0,o=[],n.jQuery.isArray(t))for(f&&p("only one message may be sent via get method per request -- using post instead"),f=!1,a=0;a<t.length;a++)v=n.Asimov._validateAndTranslateEvent(t[a]),v.success&&o.push(v.event);else w=n.Asimov._validateAndTranslateEvent(t),w.success&&o.push(w.event);if(o.length!=0){for(s="",h=0;h<o.length;h++)h>0&&(s+="\n"),s+=n.JSON.stringify(o[h]);l="";f&&(l=encodeURIComponent(s),n.Asimov.uploadUrl.length+n.Asimov.getMethodQueryStringParameter.length+2+l.length>n.Asimov.allowedGetLength&&(p("event is too large to send using get -- using post instead"),f=!1));r==="jQuery"?(b={},b=f?{accepts:{text:"application/json"},url:n.Asimov.uploadUrl,type:"get",dataType:"text",data:n.Asimov.getMethodQueryStringParameter+"="+l,crossDomain:!0}:{accepts:{text:"application/json"},url:n.Asimov.uploadUrl,type:"post",dataType:"text",data:s,crossDomain:!0,headers:{"Content-Type":"application/x-json-stream"}},e=window.jQuery.ajax(b),e.fail?e.fail(y):e.error(y),e.done?e.done(c):e.success(c)):r==="XDomainRequest"&&(u=new XDomainRequest,u.onload=c,u.onerror=function(){g(u)},f?(u.open("get",n.Asimov.uploadUrl+"?"+n.Asimov.getMethodQueryStringParameter+"="+l),u.send()):(u.open("post",n.Asimov.uploadUrl),u.send(s)))}}};this.Asimov.writeEvent=function(n){b(n,!1)};this.Asimov.writeEventWithGet=function(n){b(n,!0)};this.Asimov._validateAndTranslateEvent=function(n){var r={},c={},a={},e={event:r,success:!1},h,s,p,v,y,b,k,d;if(!n)return t("Unable to write null event"),e;if(!n.name)return t("Unable to write event with missing name"),e;if(!this._schemas.hasOwnProperty(n.name))return t("Unable to write event: a schema for the event named {"+n.name+"} does not exist"),e;if(!n.content)return t("Unable to write event: the event is missing content"),e;h=this._schemas[n.name];for(s in h)if(s!=="name"){if(p=h[s],!n.content.hasOwnProperty(s))return t("Unable to write event: missing expected part: "+s),e;if(p.part=="C"?v=a:(v={},a.baseData=v,a.baseType=s),!w(v,p.def,n.content[s]))return e}for(y in n.content)h[y]&&h[y].part||t("An unexpected property was found in the event content and dropped: "+y);if(r.ver=this.commonSchemaEnvelopeVersion,r.name=n.name,r.time=new Date,r.data=a,r.tags={},r.os=u,n.hasOwnProperty(this.correlationVectorTag))if(this.CorrelationVector.isValid(n[this.correlationVectorTag]))r.cV=n[this.correlationVectorTag];else return t("Unable to write event: The correlation vector value is invalid: "+n[this.correlationVectorTag]),e;else r.cV=this.cv.getValue();if(n.hasOwnProperty(this.experimentIdTag))if(i("string",n[this.experimentIdTag]))b={},b[this.experimentIdTag]=n[this.experimentIdTag],c.app=b;else return t("Unable to write event: The supplied experiment id is invalid: "+n[this.experimentIdTag]),e;return r.tags[this.originatingCLLTag]="JSLL",n.hasOwnProperty(f)?i("string",n[f])?r.appId=o+n[f]:t("Unable to write event: The supplied appId is invalid: "+n[f]):r.appId=o+l,k={},k.libVer=this.javascriptVersion,c.javascript=k,this.userId!=null&&(i("string",this.userId)?(d={},d.localId=this.userId,c.user=d):t("ignoring the userid value because it is invalid: "+this.userId)),r.ext=c,e.success=!0,e};this.Asimov._registerSchemas=function(n){for(var t=0;t<n.length;t++)this._schemas[n[t].name]=n[t]}})(),function(){this.Asimov._registerSchemas([{name:"Ms.Webi.ClientError","Ms.Webi.ClientError":{part:"C",def:{fields:[{req:!0,name:"errorInfo",type:"string"},{name:"wasDisplayed",type:"bool"},{name:"customSessionGuid",type:"string"},{name:"impressionGuid",type:"string"}]}}},{name:"Ms.Webi.OutgoingRequest","Ms.Qos.OutgoingServiceRequest":{part:"B",def:{fields:[{req:!0,name:"operationName",type:"string"},{name:"targetUri",type:"string"},{req:!0,name:"latencyMs",type:"int32"},{name:"serviceErrorCode",type:"int32"},{req:!0,name:"succeeded",type:"bool"},{name:"requestMethod",type:"string"},{name:"responseContentType",type:"string"},{name:"protocol",type:"string"},{name:"protocolStatusCode",type:"string"},{req:!0,name:"dependencyOperationName",type:"string"},{name:"dependencyOperationVersion",type:"string"},{req:!0,name:"dependencyName",type:"string"},{name:"dependencyType",type:"string"},{name:"responseSizeBytes",type:"int32"},{name:"requestStatus",type:"int32"}]}},"Ms.Webi.OutgoingRequest":{part:"C",def:{fields:[{name:"customSessionGuid",type:"string"},{name:"impressionGuid",type:"string"},{name:"message",type:"string"},{name:"retryCount",type:"int32"},{name:"customData",type:"string"}]}}},{name:"Ms.Webi.PageAction","Ms.Content.PageAction":{part:"B",def:{fields:[{req:!0,name:"pageName",type:"string"},{name:"uri",type:"string"},{name:"destUri",type:"string"},{name:"pageType",type:"string"},{name:"pageTags",type:"string"},{name:"product",type:"string"},{name:"screenState",type:"int32"},{name:"customSessionGuid",type:"string"},{name:"impressionGuid",type:"string"},{name:"actionInputMethod",type:"int32"},{name:"behavior",type:"int32"},{name:"contentJsonVer",type:"float"},{name:"content",type:"string"}]}},"Ms.Webi.PageAction":{part:"C",def:{fields:[{name:"flightId",type:"string"},{name:"timeToAction",type:"int32"},{name:"scrollCount",type:"int32"}]}}},{name:"Ms.Webi.PageView","Ms.Content.PageView":{part:"B",def:{fields:[{req:!0,name:"pageName",type:"string"},{name:"uri",type:"string"},{name:"referrerUri",type:"string"},{name:"pageType",type:"string"},{name:"pageTags",type:"string"},{name:"product",type:"string"},{name:"screenState",type:"int32"},{name:"customSessionGuid",type:"string"},{name:"impressionGuid",type:"string"},{name:"contentJsonVer",type:"float"},{name:"content",type:"string"}]}},"Ms.Webi.PageView":{part:"C",def:{fields:[{name:"flightId",type:"string"},{name:"utcOffset",type:"int32"},{req:!0,name:"userAgent",type:"string"},{name:"languages",type:"string"},{name:"dnt",type:"string"},{name:"cookieEnabled",type:"bool"},{name:"slInstalled",type:"bool"},{name:"slEnabled",type:"bool"},{name:"slVersion",type:"string"},{name:"flashInstalled",type:"bool"},{name:"flashVersion",type:"string"},{name:"browserSize",type:"string"},{name:"cookies",type:"string"},{name:"pageLoadTime",type:"int32"},{name:"screenRes",type:"string"},{name:"signInStatus",type:"int32"}]}}},{name:"Ms.Webi.PartialPageView","Ms.Content.PageView":{part:"B",def:{fields:[{req:!0,name:"pageName",type:"string"},{name:"uri",type:"string"},{name:"referrerUri",type:"string"},{name:"pageType",type:"string"},{name:"pageTags",type:"string"},{name:"product",type:"string"},{name:"screenState",type:"int32"},{name:"customSessionGuid",type:"string"},{name:"impressionGuid",type:"string"},{name:"contentJsonVer",type:"float"},{name:"content",type:"string"}]}},"Ms.Webi.PartialPageView":{part:"C",def:{fields:[]}}},{name:"Ms.Webi.PreLoad","Ms.Webi.PreLoad":{part:"C",def:{fields:[{name:"uri",type:"string"},{name:"referrerUri",type:"string"},{req:!0,name:"pageName",type:"string"},{name:"customSessionGuid",type:"string"},{name:"impressionGuid",type:"string"}]}}}])}();
(function(n){n.fn.extend({inViewport:function(t){var i=this.filter(function(){return n.inViewport(this,t)});return this.pushStack(i)},mostVisible:function(){var u=this.inViewport(),i=0,t,r;return u.each(function(u,f){t=n(f).data("vpVisibility");t>i&&(i=t,r=f)}),n(r)}});var t={offsetTop:0,offsetBottom:0};n.inViewport=function(i,r){var e=n(i),f,h,c,u,l,o,a,v,y,s;return f=n.extend({},t,r||{}),h=n(window).scrollTop(),c=n(window).height()-f.offsetTop-f.offsetBottom,u=e.height(),l=e.offset(),o=l.top-h-f.offsetTop,a=o+u,v=Math.max(0,Math.min(o-(c-u),u)),y=Math.max(0,Math.min(a,u)),s=(y-v)/u,e.data("vpVisibility",s),s}})(jQuery);
define("window",[],function(){return window});define("ember",["window"],function(n){return n.Ember});define("ember-data",["window"],function(n){return n.DS});!require.specified("jquery")&&window.jQuery&&(define.amd.jQuery=!1,define("jquery",[],function(){return window.jQuery}));define("commerce",[],function(){return window.commerce});define("extend",["jquery"],function(n){return n.extend});define("document",[],function(){return document});define("Math",[],function(){return Math});define("console",["window"],function(n){var t=n.console||{},i=t.log||function(){};return["log","info","warn","error","trace"].forEach(function(n){t[n]||(t[n]=i)}),t});define("deferred",["jquery"],function(n){return n.Deferred});define("when",["jquery"],function(n){return n.when});define("stack",["window"],function(n){return n.printStackTrace});define("jsll",["window"],function(n){return n.Asimov});define("WinJS",["window"],function(n){return n.WinJS});define("knockout",["window"],function(n){return n.ko});define("alert",["window"],function(n){return n.alert});define("Handlebars",["window"],function(){return window.Handlebars});define("WebBlender",["window"],function(){return window.WebBlender});
define("createGuid",function(){return function(){function n(){return Math.floor(Math.random()*16).toString(16)}var t="xxxxxxxx-xxxx-4xxx-Rxxx-xxxxxxxxxxxx".replace(/x/g,n);return t.replace("R",(8|Math.floor(Math.random()*3)).toString(16))}});define("timeSpanHandler",[],function(){function t(t,i){var r=(new Date).getTime();if(i)return r-n[t];n[t]=r}var n={};return{recordTimeSpan:t}});define("cookie",["document"],function(n){function r(n,i){var e=t(n),f,r,u;if(e&&i)for(f=e.split("&"),r=0;r<f.length;r++)if(u=f[r].split("="),u[0]&&i.toLowerCase()===u[0].toLowerCase())return u[1];return null}function t(t){for(var f=n.cookie.split("; "),u,e,r=0;r<f.length;r++)if(u=f[r].split("="),e=i(u.shift()),e===t)return i(u.join("="));return null}function i(n){var t=decodeURIComponent(n.replace("/+/g"," "));return t.indexOf('"')===0&&(t=t.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\")),t}return{getCookie:t,getCookieKeyValue:r,setCookie:function(n,t,i){var u,r;i?(r=new Date,r.setTime(r.getTime()+i*864e5),u="; expires="+r.toUTCString()):u="";window.document.cookie=n+"="+t+u+"; path=/;"},deleteCookie:function(n){this.setCookie(n,"",-1)}}});define("ids",["cookie","jquery"],function(n,t){function u(n){i=n}function f(){return n.getCookie("MS0")}function e(){return n.getCookie("MUID")}function o(){return r}function s(){return i?i:t("meta[name='ms.Cv']").attr("content")}function h(n){r=n}function c(){return n.getCookie("Flights")}function l(){return n.getCookie("Treatments")}var r,i;return{getSessionId:f,getVisitorId:e,setImpressionGuid:h,getImpressionGuid:o,getCv:s,getFlights:c,getGroups:l,setCVValue:u}});define("vortexEvents",["jsll","ids"],function(n,t){function u(n){var r={name:"Ms.Webi.PageView",content:{"Ms.Content.PageView":{uri:n.pageUri,pageName:n.pageName,referrerUri:n.referrerUri,pageTags:n.pageTags,customSessionGuid:t.getSessionId(),impressionGuid:t.getImpressionGuid(),contentJsonVer:2,content:n.content,product:n.product,pageType:n.pageType,screenState:n.screenState},"Ms.Webi.PageView":{flightId:n.flightId,utcOffset:n.utcOffset,userAgent:navigator.userAgent,languages:navigator.userLanguage,dnt:navigator.doNotTrack,cookieEnabled:n.cookieEnabled,slInstalled:n.slInstalled,slEnabled:n.slEnabled,slVersion:n.slVersion,flashInstalled:n.flashInstalled,flashVersion:n.flashVersion,browserSize:n.browserSize,cookies:n.cookies,pageLoadTime:n.pageLoadTime,screenRes:n.screenRes,signInStatus:n.signInStatus}}};i(r)}function f(n){var r={name:"Ms.Webi.PartialPageView",content:{"Ms.Content.PageView":{uri:n.pageUri,pageName:n.pageName,referrerUri:n.referrerUri,pageTags:n.pageTags,customSessionGuid:t.getSessionId(),impressionGuid:t.getImpressionGuid(),contentJsonVer:2,content:n.content},"Ms.Webi.PartialPageView":{}}};i(r)}function e(n){var r={name:"Ms.Webi.PreLoad",content:{"Ms.Webi.PreLoad":{uri:n.pageUri,referrerUri:n.referrerUri,pageName:n.pageName,customSessionGuid:t.getSessionId(),impressionGuid:t.getImpressionGuid()}}};i(r)}function o(n){var r={name:"Ms.Webi.PageAction",content:{"Ms.Content.PageAction":{uri:n.pageUri,pageName:n.pageName,destUri:n.targetUri,pageTags:n.pageTags,customSessionGuid:t.getSessionId(),impressionGuid:t.getImpressionGuid(),contentJsonVer:2,content:n.content,product:n.product,pageType:n.pageType,screenState:n.screenState,actionInputMethod:n.inputMethod,behavior:n.behavior},"Ms.Webi.PageAction":{flightId:n.flightId,timeToAction:n.timeToAction,scrollCount:n.scrollCount}}};i(r)}function s(n,r){var u={name:"Ms.Webi.ClientError",content:{"Ms.Webi.ClientError":{errorInfo:JSON.stringify(n),wasDisplayed:r||!1,customSessionGuid:t.getSessionId(),impressionGuid:t.getImpressionGuid()}}};i(u)}function h(n){var r={name:"Ms.Webi.OutgoingRequest",content:{"Ms.Qos.OutgoingServiceRequest":{operationName:n.currentOperationName,targetUri:n.requestUri,latencyMs:n.latencyMs,serviceErrorCode:n.serviceErrorCode||-1,succeeded:n.isSuccess,requestMethod:n.httpMethod,responseContentType:n.contentType,protocolStatusCode:n.httpStatusCode||"",dependencyOperationName:n.operationName,dependencyOperationVersion:n.operationVersion,dependencyName:n.serviceName,dependencyType:n.serviceType||"WebService",responseSizeBytes:n.responseSize},"Ms.Webi.OutgoingRequest":{customSessionGuid:t.getSessionId(),impressionGuid:t.getImpressionGuid(),message:n.errorMessage,retryCount:n.retryCount,customData:n.customData}}};i(r,n.cV)}function i(i,u){var f=u,e;u||(f=t.getCv());n.CorrelationVector.isValid(f)&&(i[n.correlationVectorTag]=f);r&&(i.appId=r);e=t.getGroups();e&&(i.expId=e);n.writeEventWithGet(i)}var r;return n.consoleVerbosity=n.verbosityLevels.ERROR,{setAppId:function(n){r=n},sendError:s,sendPageAction:o,sendPageView:u,sendApiComplete:h,sendPartialPageView:f,sendPreLoad:e}});define("windowErrorHandler",["window"],function(n){return function(t){var i=n.onerror;n.onerror=function(){i&&i.apply(this,arguments);t.apply(this,arguments)}}});define("defaultErrorHandler",["windowErrorHandler","vortexEvents","window"],function(n,t,i){function r(){if(arguments){var n={Page:i.location.href,Script:arguments[1]||"",Message:arguments[0]||"",LineNumber:arguments[2]||0,UserAgent:i.navigator.userAgent||"",Platform:i.navigator.platform||""};t.sendError(n,!1)}}function u(){n(r)}return{init:u}});define("service",["jquery","vortexEvents","timeSpanHandler","window"],function(n,t,i,r){var u=function(u){function c(n,i,s){var c=n.getResponseHeader("Content-Length"),l={serviceName:u.serviceName,operationName:h,operationVersion:u.version&&u.version.toString(),httpStatusCode:n.status&&n.status.toString(),isSuccess:i,serviceErrorCode:!i&&n.responseJSON&&n.responseJSON.code?n.responseJSON.code:-1,requestUri:f.url,httpMethod:f.type,contentType:f.dataType,latencyMs:s,cV:n.getResponseHeader("MS-CV")||e["MS-CV"],retryCount:o,responseSize:c&&parseInt(c),errorMessage:n.errorThrown,currentOperationName:u.currentOperationName||r.location.href};t.sendApiComplete(l)}function l(){var t=h+"_Retry_"+o;return i.recordTimeSpan(t),n.ajax(f).then(function(n,r,u){var f=i.recordTimeSpan(t,!0);return c(u,!0,f),u},function(r,u){var e=i.recordTimeSpan(t,!0),f;return c(r,!1,e),f=n.Deferred(),v>o&&(r.status===0||r.status>=500&&r.status<600)?(o++,setTimeout(function(){l().done(f.resolve).fail(f.reject)},50)):f.reject(r,u),f.promise()})}n.support.cors=!0;var e=u.additionalHeaders||{},s=u.body,a=s?JSON.stringify(s):u.data||undefined,v=u.maxRetry||0,o=0,y=n.noop,h=u.operationName||u.url,p=u.errorFormatter||function(n){return n},f={url:u.url,type:u.method,data:a,crossDomain:!0,headers:{},success:u.success,error:u.error,jsonp:u.jsonp,jsonpCallback:u.jsonpCallback,cache:u.cache,beforeSend:function(n){if(y(n),u.contractVersion&&n.setRequestHeader("MS-Contract-Version",u.contractVersion),e)for(var t in e)n.setRequestHeader(t,e[t])},defaultError:u.defaultError};return u.dataType!=="auto"&&(f.dataType=u.dataType||"json"),u.noCacheBusting||(f.cache=!1),u.contentType&&(f.headers["Content-Type"]=u.contentType),u.accept&&(f.headers.Accept=u.accept),l().then(function(n){return n},function(n){return p(n,u)})};return{post:function(t){return u(n.extend({},t,{method:"POST"}))},get:function(t){return u(n.extend({maxRetry:1},t,{method:"GET"}))},put:function(t){return u(n.extend({},t,{method:"PUT"}))},del:function(t){return u(n.extend({},t,{method:"DELETE"}))}}});define("pageName",function(){return function(){var t=window.location.pathname||"Home",n=t.split("/");return n.length>2&&n[2]!==""?n[2]:"Home"}});define("clickstreamTracker",["vortexEvents","cookie","jquery","document","window","createGuid","ids","pageName","defaultErrorHandler"],function(n,t,i,r,u,f,e,o,s){function et(n){e.setImpressionGuid(f());ct();c=n&&ft[n]?n:"microsoft.com";d=ft[c];k&&s.init();i(function(){b&&ot();w&&i(r).click(st);p&&(r.readyState==="complete"?tt():i(u).load(tt))})}function ot(){if(!(u.location.host.indexOf(c)<0)){var t=u.location.protocol+"//"+d+"/c.gif?DI=4050&did=1&t=",n=r.createElement("IMG");n.style.display="none";n.src=t;r.body.appendChild(n)}}function st(n){for(var e={A:!0,BUTTON:!0,AREA:!0,INPUT:!0},r=n||u.event,t=r.srcElement||r.target,f;t&&t.tagName;)if(e[t.tagName.toUpperCase()]){f=i(t).attr("data-bi-dnt");f===undefined&&v(t);break}else{t=t.parentElement||t.parentNode;continue}}function tt(){it()}function it(t){var i={},f,s,r,v,c;if(i.utcOffset=kt(),i.referrerUri=l,i.cookieEnabled=ri(),i.browserSize=ii(),i.screenRes=u.screen&&screen.width+"x"+screen.height,i.pageUri=h,i.cookies=wt(),i.content=rt(),i.flightId=e.getFlights(),i.signInStatus=a,g&&(f=ni(),i.slInstalled=f.installed||!1,i.slEnabled=f.enabled||!1,i.slVersion=f.version||"",s=gt(),i.flashInstalled=s.installed||!1,i.flashVersion=s.version||""),r={},u.performance&&u.performance.timing){if(nt===!0)try{v=u.performance.getEntries().filter(function(n){return n.initiatorType==="script"||n.initiatorType==="link"});r.AssetPerformance=JSON.stringify(v)}catch(y){}r.timing=JSON.stringify(u.performance.timing);i.pageLoadTime=u.performance.timing.domComplete-u.performance.timing.fetchStart}if(r.metaTags=ti(),t)for(c in t)r[c]=t[c];i.pageTags=JSON.stringify(r);i.pageName=o();n.sendPageView(i)}function ht(t,i,r){var u={};u.referrerUri=l;u.pageUri=h;u.content=rt(t);u.pageLoadTime=i;u.pageName=o();r&&(u.pageTags=JSON.stringify(r));n.sendPartialPageView(u)}function ct(){var t={};t.referrerUri=l;t.pageUri=h;t.pageName=o();n.sendPreLoad(t)}function lt(n,t){v(null,t,n)}function at(n,t){v(n,t,null)}function v(t,r,u){var f={},s;f.timeToAction=vt();s={};t?(f.targetUri=bt(t),f.content=yt(t),s=dt(t)):u&&(f.targetUri=u.targetUri,f.content=pt(u));r&&(s=i.extend(s,r));f.pageTags=JSON.stringify(s);f.pageUri=h;f.pageName=o();f.flightId=e.getFlights();n.sendPageAction(f)}function vt(){var t=(new Date).getTime(),n;return u.performance&&u.performance.timing&&(n=u.performance.timing.domComplete,n!==0)?t-n:-1}function rt(n){var o=[],f,r,u,e,t,s;for(n?(r=i("#"+n),r=r&&r.length===1&&r[0],f=i("[data-bi-slot]",i(r)).inViewport()):f=i("[data-bi-slot]").inViewport(),e=0;e<f.length;e++)t=i(f[e]),u=ut(t),s={areaName:u.areaName,slotNumber:t.attr("data-bi-slot"),templateName:u.templateName,contentId:t.attr("data-bi-id"),contentName:t.attr("data-bi-name")||t.attr("name")||t.attr("alt")||"",contentSource:t.attr("data-bi-source")||u.contentSource,product:t.attr("data-bi-product")||u.product,contentType:t.attr("data-bi-type")||u.type},o.push(s);return y(o)}function yt(n){if(!n)return"";var r=ut(n),f=[],u=i(n).closest("[data-bi-name]"),t=u&&u.length===1?i(u[0]):i(n),e={areaName:r.areaName,slotNumber:t.attr("data-bi-slot"),templateName:r.templateName,contentId:t.attr("data-bi-id"),contentName:t.attr("data-bi-name")||t.attr("name")||t.attr("alt")||t.attr("value")||t.innerText||"",contentSource:t.attr("data-bi-source")||r.contentSource,product:t.attr("data-bi-product")||r.product,contentType:t.attr("data-bi-type")||r.type};return f.push(e),y(f)}function ut(n){var r=i(n).closest("[data-bi-area]"),t=r&&r.length===1?i(r[0]):i(n);return{areaName:t.attr("data-bi-area"),templateName:t.attr("data-bi-view"),contentSource:t.attr("data-bi-source"),product:t.attr("data-bi-product"),type:t.attr("data-bi-type")}}function pt(n){var t=[],i={areaName:n.areaName,slotNumber:n.slotNumber,templateName:n.templateName,contentId:n.contentId,contentName:n.name,contentSource:n.contentSource,product:n.product};return t.push(i),y(t)}function y(n){return JSON.stringify(n)}function wt(){var f="",e={},n=["ANON","MC1","MSFPC"],t,i;try{try{u.varCustomerCookies&&u.varCustomerCookies.length>0&&(n=n.concat(u.varCustomerCookies))}catch(o){}for(t in n)e.hasOwnProperty(n[t])||(e[n[t]]="",i=decodeURIComponent(r.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(n[t]).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1")),i!=""&&(f+=n[t]+"="+i+";"))}catch(o){}return f}function bt(n){var i="",t;switch(n.tagName){case"A":case"AREA":i=n.href||"";break;case"IMG":i=fi(n);break;case"INPUT":t=n.type;(t&&(t=="button"||t=="reset"||t=="submit"||t=="image"||t=="radio")||t=="text"&&(n.which||n.keyCode)==13)&&(i=n.form?n.form.action||u.location.pathname:u.location.pathname)}return i}function kt(){var n,t=new Date;return n=t.getTimezoneOffset(),n/-60}function dt(n){for(var r={},t,i;n;)if(!ei(n)){for(t in n.attributes)t&&n.attributes[t]&&(i=n.attributes[t].name,i&&i.toLowerCase().indexOf("ms.")==0&&(r[i]=n.attributes[t].value));n=n.parentElement||n.parentNode}return r}function gt(){var n={},i,r,t,u;if(navigator.plugins["Shockwave Flash"])n.installed=!0,i=navigator.plugins["Shockwave Flash"],n.version=i.description.split(" ")[2];else if(navigator.userAgent.indexOf("MSIE")!=-1)for(r=(new Date).getFullYear()-1992,t=r;t>0;t--)try{u=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+t);n.installed=!0;n.version=t+".0";break}catch(f){}return n}function ni(){var n={},f,t,i,r;u.Silverlight!=undefined&&(n.enabled=!0);try{navigator.plugins["Silverlight Plug-In"]?(f=navigator.plugins["Silverlight Plug-In"],n.installed=!0,t=f.description,t&&(i=t.split("."),t=i[0]+"."+i[1],n.version=t)):navigator.userAgent.indexOf("MSIE")!=-1&&(r=new ActiveXObject("AgControl.AgControl"),r&&(n.installed=!0,n.version=ui(r)))}catch(e){}return n}function ti(){for(var u={},n,f,r=i("meta"),t=0;t<r.length;t++)n=r[t],n.name&&(f=n.name.toLowerCase(),f.indexOf("ms.")==0&&(u[n.name]=n.content));return u}function ii(){var n="";return r.body&&r.body.clientWidth?n=r.body.clientWidth+"x"+r.body.clientHeight:r.documentElement&&r.documentElement.clientWidth?n=r.documentElement.clientWidth+"x"+r.documentElement.clientHeight:u.innerWidth&&(n=u.innerWidth+"x"+u.innerHeight),n}function ri(){if(navigator.cookieEnabled)return navigator.cookieEnabled;var n="MC0",i=t.getCookie(n);return i||(r.cookie=n+"="+f(),i=t.getCookie(n)),i?!0:!1}function ui(n){for(var t="",u=(new Date).getYear()-2004,r,i=u;i>0;i--)for(r=9;r>=0;r--)if(t=i+"."+r,n.IsVersionSupported(t))return t;return t}function fi(n){var r=n,t;if(r&&(t=i(r).closest("A"),t.length===1)){if(t[0].href)return t[0].href;if(t[0].src)return t[0].src}return""}function ei(n){if(!n||!n.attributes)return!1;var t=n.getAttribute("data-bi-dnt");return t&&t.toLowerCase()==="pii"?!0:!1}var p=!0,w=!0,b=!0,k=!0,d,c,l=r.referrer,a=-1,h=u.location.href,g=!1,nt=!1,ft={"microsoft.com":"c1.microsoft.com","xbox.com":"c.xbox.com","live.com":"c.live.com","microsoftstore.com":"c.microsoftstore.com","msn.com":"c.msn.com","windows.com":"c.windows.com"};return{init:et,capturePageView:it,capturePartialView:ht,capturePageAction:at,captureContentPageAction:lt,disableAutoPageView:function(){p=!1},disableAutoClickTracking:function(){w=!1},disableMuidSync:function(){b=!1},disableJavascriptErrorTracker:function(){k=!1},enableCaptureAddInsInfo:function(){g=!0},enableCaptureAssetsPerfInfo:function(){nt=!0},setReferrer:function(n){n!=null&&(l=n)},setRequestUri:function(n){n&&(h=n)},setSignInStatus:function(n){a=n===!0?1:0},setAppId:function(t){t&&n.setAppId(t)}}})